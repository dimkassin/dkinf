# Инфрастрактура
  
## Инструкция тестирования

1. Сделайте форк или клонируйте репозиторий.

```bash
git clone https://github.com/user/repo.git
```

2. Создайте Personal Access Token (PAT) в настройках своего аккаунта GitHub. Убедитесь, что у токена есть разрешение на чтение и запись репозитория.
3. Добавьте токен в секреты репозитория под именем `PAT_SECRET`.
4. Измените код или добавьте новые коммиты, соответствующие формату Conventional Commits (подробнее есть ниже).

```bash
git commit -m "feat: add new feature"
git push origin branch-name
```

5. Откройте новый пулл реквест. Проверки CI должны автоматически запуститься.
6. Создайте новый релизный тег и запушьте его. Релизный процесс должен запуститься автоматически.

```bash
git tag v1.0.0
git push origin v1.0.0
```

7. Новые релизы появляются в разделе "Releases" вашего репозитория.

## Информация о проекте

### 1.Сообщения коммитов

Каждое сообщение коммита должно соответствовать формату Conventional Commits. Сообщения проверяются с помощью commitlint.

Сообщения коммитов в формате Conventional Commits следуют определенной структуре. Вот как выглядит общий формат:
  
```sh
<type>: <description>npm install husky --save-dev
```
type - это тип изменения, которое вы внесли в коммит. Это может быть feat (для новой функциональности),  
fix (для исправления ошибок), docs (для изменений в документации), style (для кода, который не влияет на логику работы, например,  форматирование),  
refactor (для рефакторинга кода), test (для добавления отсутствующих тестов или исправления существующих),  
chore (для обновления сборщика, добавления библиотек и т.д.).  
  
Пример:

```bash
git commit -m "feat: add new feature"
```

### 2.Проверки в CI

Автоматический запуск проверок в CI выполняется для каждого пулл реквеста. Проверки включают в себя автотесты и линтинг кода. Результат проверки отображается на странице пулл реквеста в интерфейсе GitHub. Мерж изменений возможен только в случае успешного прохождения всех проверок.

### 3.Релиз

Поскольку разрабатывался проект в приватном репозитории, то использовался PAT.

Релиз запускается автоматически при появлении нового релизного тега в формате `v<число>` (например, `v12`). В процессе релиза:

- Формируется changelog по истории коммитов от предыдущего релизного тега
- Создается запись в реестре релизов (issue на GitHub с пометкой RELEASE), в которую вносится информация о версии, авторе и дате релиза, а также changelog
- Запускаются проверки, аналогичные тем, что выполняются для пулл реквестов
- При успешном прохождении проверок приложение выкладывается на gh-pages
- В реестр релизов добавляется запись о развертывании приложения
- Релизный issue автоматически закрывается

Все автоматизированные процессы настроены через GitHub Actions.

Создание релизного тега:

```bash
git tag v1.0.0
git push origin v1.0.0
```
  
  
## Настройка проекта

```sh
git commit -m "feat: add new feature"
```

В этом репозитории находится пример приложения с тестами:

- [e2e тесты](e2e/example.spec.ts)
- [unit тесты](src/example.test.tsx)

Для запуска примеров необходимо установить [NodeJS](https://nodejs.org/en/download/) 16 или выше.

Как запустить:

```sh
# установить зависимости
npm ci

# запустить приложение
npm start
```

Как запустить e2e тесты:

```sh
# скачать браузеры
npx playwright install

# запустить тесты
npm run e2e
```

Как запустить модульные тесты:

```sh
npm test
```
